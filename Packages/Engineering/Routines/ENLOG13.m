ENLOG13 ;(WASH ISC)/DH-Handle LOG1 SPEX ;10-4-93
 ;;;;
 ;CLASS 3 SOFTWARE - Not officially supported by the ISC's
SPEX N DONE S DONE=0
 I $D(^ENG(6914,ENMERS,5)) F Z=0:0 S Z=$O(^ENG(6914,ENMERS,5,Z)) Q:Z'>0  I $D(^(Z,0)),$E(^(0),1,17)="(Begin LOG1 SPEX)" S DONE=1 Q
 I DONE Q
 K ENSPEX F ENA=21:1:29 I $D(^ENZ(6914.5,ENLOG,ENA)) S ENSPEX(ENA)=^(ENA)
 F ENA=21:1:29 D:$D(ENSPEX(ENA)) CMPRES
 I '$D(^ENG(6914,ENMERS,5)) S ^ENG(6914,ENMERS,5,0)="^^0^0"
 S ENCNT=($P(^ENG(6914,ENMERS,5,0),U,3)+1),ENSPEX(21)="(Begin LOG1 SPEX) "_ENSPEX(21)
 F ENA=21:1:29 I $D(ENSPEX(ENA)) D:$D(^ENG(6914,ENMERS,5,ENCNT)) INCR S ^ENG(6914,ENMERS,5,ENCNT,0)=ENSPEX(ENA),ENCNT=ENCNT+1
 D:$D(ENG(6914,ENMERS,5,ENCNT)) INCR S ^ENG(6914,ENMERS,5,ENCNT,0)="(End SPEX) "
 S $P(^ENG(6914,ENMERS,5,0),U,3,4)=ENCNT_U_ENCNT
 K ENSPEX,ENCNT,ENA,ENFLG,I
 Q
 ;
CMPRES S ENSPEX="",ENFLG=0
 F I=1:1:47 S X=$E(ENSPEX(ENA),I) S:'(ENFLG&(X=" ")) ENSPEX=ENSPEX_X S ENFLG=$S(X=" ":1,1:0)
 S ENSPEX(ENA)=ENSPEX_";"
 Q
 ;
INCR S ENCNT=ENCNT+1 G:$D(^ENG(6914,ENMERS,5,ENCNT)) INCR
 Q
 ;ENLOG13
