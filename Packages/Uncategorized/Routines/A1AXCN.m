A1AXCN ;SLL/ALB ISC; JCAHO CONTINGENCY RPT; 12/30/87
 ;;VERSION 1.0
 ;
 S %IS("B")="HOME",%IS="MQF" D ^%ZIS G:POP EXIT1 I '$D(IO("Q")) U IO G DQ
 S ZTRTN="DQ^A1AXCN",ZTIO=ION S ZTDESC="EXT REV CONTINGENCY REPORT" D ^%ZTLOAD W !,"PRINT QUEUED!" X ^%ZIS("C")
 K IO("Q"),ZTRTN,ZTIO,ZTDESC,A1AXNB,A1AXST,A1AXSTN,A1AXSTAT,A1AXCT,A1AXCT1,A1AXCT2,A1AXCT3,FAC,NFAC,NCAT,RANK,I,J,K,A1AXZT,Q,S,A1AX,A1AXZ,A1AXDS,A1AXL,^UTILITY($J,"CN"),X,Y,DIC,M,C,R,%,POP,ZTSK Q
DQ ;
 D CLOSE^A1AXUTL
 D ^A1AXCNST,^A1AXCNSM,^A1AXCNRK,^A1AXCNFC
 S A1AX=$P(^DIZ(11834,0),"^",4),$P(A1AXSL,"-",21*5+16)=""
CAT ;CAT
 S A1AXP=0 F I=1:1 S A1AXP=$O(^DIZ(11834,A1AXP)) G:A1AXP=""!(A1AXP'?.N) DST S A1AXNB(I)=$P(^DIZ(11834,A1AXP,0),"^",2)
 Q
DST ;
 F A1AXDS=0:0 Q:$D(A1AXEND)  S A1AXDS=$O(DIST(A1AXDS)) Q:A1AXDS=""  D SITE,WAIT^A1AXUTL Q:$D(A1AXEND)
 G:$D(A1AXEND) EXIT
 S Q=1,S=21 D SHD^A1AXCNP2,THD^A1AXCNP1,WRST^A1AXCNP2 S Q=22,S=A1AX D THD^A1AXCNP1,WRST^A1AXCNP2,BOTT^A1AXCNP2
 G EXIT
SITE ;SITE
 S Q=1,S=21 D HD^A1AXCNP1,THD^A1AXCNP1 S A1AXZ=0 F J=1:1 Q:$D(A1AXEND)  S A1AXZ=$O(DIST(A1AXDS,A1AXZ)) Q:A1AXZ=""  S A1AXST=A1AXZ,A1AXSTN=$N(^DIZ(11837,"B",A1AXST,0)) D DATA
 S Q=22,S=A1AX D HD^A1AXCNP1,THD^A1AXCNP1 S A1AXZ=0 F J=1:1 Q:$D(A1AXEND)  S A1AXZ=$O(DIST(A1AXDS,A1AXZ)) Q:A1AXZ=""  S A1AXST=A1AXZ,A1AXSTN=$N(^DIZ(11837,"B",A1AXST,0)) D DATA
 Q
DATA D FXST^A1AXCNP2,WR^A1AXCNP2
 ;D:$Y+2>IOSL WAIT^A1AXUTL Q:$D(A1AXEND)
 Q
EXIT ;
 D EXIT1,CLOSE1^A1AXUTL Q
EXIT1 ;
 K LOC,DIST,TOT,TOT1,TOT2,A1AXF1,A1AXF,A1AXNB,A1AXCONT,A1AXDS,A1AXDT,A1AXP,A1AXPC,A1AXSUM,A1AXZ,A1AXZT,CAT,DST,F,RANKAC
 K N,POP,PRG,RCM,REC,SCT,SUB,T,Y
 K A1AX,A1AXCT,A1AXCT1,A1AXCT2,A1AXCT3,A1AXST,A1AXSTAT,A1AXSTN,A1AXL,A1AXSL,A1AXEND,A1AXSTOP,FAC,I,J,K,NCAT,NFAC,RANK,S,Q,^UTILITY($J,"CN")
 K X,C,D,L,%,IO("Q"),%DAT,%DAT1,%DT,% I $D(ZTSK) K ^%ZTSK(ZTSK),ZTSK
 Q
