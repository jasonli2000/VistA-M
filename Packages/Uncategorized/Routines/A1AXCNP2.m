A1AXCNP2 ;SLL/ALB ISC; JCAHO CONTINGENCY REPORT PRINT PROCESSING; 12/1/87
 ;;VERSION 1.0
 ;PAGE
 ;SITE NAME
FXST ;
 I DUZ(2)>999 G SETNM
 I DUZ(2)<1000 G @$S(A1AXSTN=DUZ(2):"SETNM",1:"SETNUL")
 Q
SETNUL S (A1AXCT,A1AXCT1,A1AXCT2,A1AXCT3,A1AXSTAT)="" Q
SETNM S A1AXSTAT=$P(A1AXST,",",2),A1AXCT=$P(A1AXST,",",1)
 I (A1AXCT'["/")&(A1AXCT'[" ") S A1AXCT1=A1AXCT,A1AXCT2="",A1AXCT3=""
 I A1AXCT[" " S A1AXCT1=$P(A1AXCT," ",1),A1AXCT2=$P(A1AXCT," ",2),A1AXCT3=$P(A1AXCT," ",3)
 I A1AXCT["/" S A1AXCT1=$P(A1AXCT,"/",1)_"/",A1AXCT2=$P(A1AXCT,"/",2),A1AXCT3=$P(A1AXCT,"/",3)
 Q
 ;GET HIGH PRIO (+) AND CONTINGENCY (RC,C) DATA
WR ;
 ;I $Y+3>IOSL D WAIT^A1AXUTL Q:$D(A1AXEND)  D THD^A1AXCNP1
 S A1AXZT=$P(^UTILITY($J,"CN",A1AXSTN),"^",3) S A1AXDT="" S:$D(A1AXZT)&(A1AXZT'["-") A1AXDT=$S(A1AXZT'="":$E(A1AXZT,4,5)_"/"_$E(A1AXZT,6,7)_"/"_$E(A1AXZT,2,3),1:"")
1 W !,A1AXCT1 W ?12,"+" S L=0 F K=Q:1:S S C=5*L+16,L=L+1 W:$D(^UTILITY($J,"CN",A1AXSTN,"PLUS")) ?C,$P(^UTILITY($J,"CN",A1AXSTN,"PLUS"),"^",K+1)
 I S=A1AX S C=C+8 I $D(^UTILITY($J,"CN",A1AXSTN,"PLUS")) W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"PLUS"),"^",1) ;S C=C+5 W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"PLUS"),"^",1)*100\$P(TOT1,"^",4)
 W ! W:A1AXCT2'="" A1AXCT2 W:A1AXCT2="" " "_A1AXSTAT
2 W ?12,"C"
 S L=0 F K=Q:1:S S C=5*L+16,L=L+1 W:$D(^UTILITY($J,"CN",A1AXSTN,"C")) ?C,$P(^UTILITY($J,"CN",A1AXSTN,"C"),"^",K+1)
 I S=A1AX S C=C+8 I $D(^UTILITY($J,"CN",A1AXSTN,"C")) W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"C"),"^",1) ;S C=C+5 W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"C"),"^",1)*100\$P(TOT1,"^",2)
NWR W ! W:A1AXCT3'="" A1AXCT3 W:(A1AXCT2'="")&(A1AXCT3="") " "_A1AXSTAT I $D(^UTILITY($J,"CN",A1AXSTN))&(A1AXCT2="")&(A1AXCT3="") W A1AXDT
3 W ?12,"RC" S L=0 F K=Q:1:S S C=5*L+16,L=L+1 W:$D(^UTILITY($J,"CN",A1AXSTN,"RC")) ?C,$P(^UTILITY($J,"CN",A1AXSTN,"RC"),"^",K+1)
 I S=A1AX S C=C+8 I $D(^UTILITY($J,"CN",A1AXSTN,"RC")) W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"RC"),"^",1) ;S C=C+5 W ?C,$P(^UTILITY($J,"CN",A1AXSTN,"RC"),"^",1)*100\$P(TOT1,"^",3)
4 W:(A1AXCT2'="")&(A1AXCT3'="") !," "_A1AXSTAT W:(A1AXCT2'="")&(A1AXCT3="") !,A1AXDT ;I S=A1AX S C=5*(S-Q+1)+15 W !,?C,"----------------"
5 W:(A1AXCT2'="")&(A1AXCT3'="") !,A1AXDT
 I S=A1AX S C=5*(S-Q+1)+16 W !,?C,"-------------"
 S (A1AXSUM,A1AXPC)=0
 I $D(^UTILITY($J,"CN",A1AXSTN,"PLUS")) S A1AXSUM=A1AXSUM+$P(^UTILITY($J,"CN",A1AXSTN,"PLUS"),"^",1)
 I $D(^UTILITY($J,"CN",A1AXSTN,"C")) S A1AXSUM=A1AXSUM+$P(^UTILITY($J,"CN",A1AXSTN,"C"),"^",1)
 I $D(^UTILITY($J,"CN",A1AXSTN,"RC")) S A1AXSUM=A1AXSUM+$P(^UTILITY($J,"CN",A1AXSTN,"RC"),"^",1)
 I S=A1AX I A1AXSUM'=0 S C=5*(S-Q+1)+19 W !,?C,A1AXSUM
 ;I A1AXSUM'=0 S C=C+5 W ?C,A1AXSUM*100\$P(TOT1,"^",1)
 I S=A1AX S C=C+5 W:$D(^UTILITY($J,"CN",A1AXSTN,"TOT")) ?C,$P(^UTILITY($J,"CN",A1AXSTN,"TOT"),"^",2)
 W !,A1AXSL
 Q
STAT ;
SHD ;
 S X="JCAHO CONTINGENCY REPORT STATISTICS FROM ALL FACILITIES" W #,!!,?(5*(S-Q+1)+30-$L(X)\2),X S %DT=+$H D %CDS^%H S Y=$P(%DAT1,"-",2)_" "_$P(%DAT1,"-",1)_",19"_$P(%DAT1,"-",3) S X="AS OF "_Y W !,?(5*(S-Q+1)+30-$L(X)\2),X
 W !,"TOT CONT: SUM OF +, C, RC"
 W !,"TOT FAC: NUMBER OF FACILITY WITH +, C OR RC"
 Q
WRST ;
 W !,"TOT CONT:" S L=0 F K=Q:1:S S C=5*L+16,L=L+1 W ?C,$P(TOT1,"^",K+4)
 I S=A1AX S C=C+5 W ?C,$P(TOT1,"^",1)
 W !,"TOT FAC:" S L=0 F K=Q:1:S S C=5*L+16,L=L+1 W ?C,$P(TOT2,"^",K+4)
 I S=A1AX S C=C+5 W ?C,$P(TOT2,"^",1)
 W !,A1AXL
 Q
BOTT ;
 W !,"SUM OF  ""C"" FOR ALL SITES, ALL CATEGORIES=  ",$P(TOT1,"^",2)
 W !,"SUM OF ""RC"" FOR ALL SITES, ALL CATEGORIES=  ",$P(TOT1,"^",3)
 W !,"SUM OF  ""+"" FOR ALL SITES, ALL CATEGORIES=  ",$P(TOT1,"^",4)
 W !,A1AXL K A1AXL
 Q
