A1AXCTS ;SLL/ALB ISC; FACILITY CATEGORY STATISTICS; 3/23/88
 ;;VERSION 1.0
 ;
 Q:DUZ(2)'<999
OPT ;
 S A1AXOPT="F"
DEVICE ;
 S %IS("B")="HOME",%IS="MQF" D ^%ZIS G:POP EXIT1 I '$D(IO("Q")) U IO G DQ
 S ZTRTN="DQ^A1AXCTS",ZTIO=ION S ZTSAVE("A1AX*")="" S ZTDESC="EXT REV CAT STAT REPORT" D ^%ZTLOAD W !,"PRINT QUEUED!" X ^%ZIS("C")
 K IO("Q"),ZTRTN,ZTIO,ZTDESC,ZTSAVE,%DT("A"),%DT("B"),A1AXL,AU,AA,AP,AS,AR,I,J,A1AXOPT,A1AXO,A1AXF,A1AXCT,A1AXDT,A1AX1,A1AX2,A1AXST,A1AXSTOP,A1AXEND,A1AXM,A1AXWDT
 K ^UTILITY($J,"CAT"),^UTILITY($J,"LAST")
 K A1AXD,A1AXG,A1AXU,A1AXI,I,J,L
 Q
DQ ;
 D CLOSE^A1AXUTL
 S A1AX1=$P(^DIZ(11837,DUZ(2),0),"^",1),A1AXD=$P(^(0),"^",2)
 S A1AX2="" F I=0:0 S A1AX2=$O(^DIZ(11831,"B",A1AX2)) Q:A1AX2=""  D SETF
 D LASTF
 D ^A1AXCTS1
 Q
SETF ;
 S ^UTILITY($J,"CAT",A1AXD,A1AX1,A1AX2)=""
 S ^UTILITY($J,"LAST",A1AX1,A1AX2)=""
 Q
LASTF ;
 F AN=0:0 S AN=$N(^DIZ(11830,"F",AN)) Q:AN<0  F AA=0:0 S AA=$N(^DIZ(11830,"F",AN,AA)) Q:AA<0  D LASTL
 Q
LASTL ;
 Q:AN'=DUZ(2)
 S A1AXDT=^DIZ(11830,AA,0),A1AX1=$P(^DIZ(11837,^("F"),0),"^",1),A1AX2=$P(^DIZ(11831,^DIZ(11830,AA,"O"),0),"^",1) Q:'$D(^DIZ(11830,AA,"D"))  Q:$P(^("D"),"^",1)=""  I A1AXDT>^UTILITY($J,"LAST",A1AX1,A1AX2) S ^UTILITY($J,"LAST",A1AX1,A1AX2)=A1AXDT
 Q
EXIT1 ;
 K %DT("A"),%DT,%DT("B"),IO("Q"),A1AXOPT
 Q
