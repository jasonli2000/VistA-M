A1AXCTS1 ;SLL/ALB ISC; FACILITY CATEGORY STATISTICS; 3/23/88
 ;;VERSION 1.0
 ;
LOOP ;
 S AU="" F II=0:0 S AU=$O(^DIZ(11830,"RECOM",AU)) Q:AU=""  F AA=0:0 S AA=$N(^DIZ(11830,"RECOM",AU,AA)) Q:AA<0  F AP=0:0 S AP=$N(^DIZ(11830,"RECOM",AU,AA,AP)) Q:AP<0  D LOOP1
 D ^A1AXCTS2
 Q
LOOP1 ;
 F AS=0:0 S AS=$N(^DIZ(11830,"RECOM",AU,AA,AP,AS)) Q:AS<0  F AR=0:0 S AR=$N(^DIZ(11830,"RECOM",AU,AA,AP,AS,AR)) Q:AR<0  D SET
 Q
SET ;
 K A1AXCAT
 Q:DUZ(2)'=+^DIZ(11830,AA,"F")
 S A1AXDT=+^DIZ(11830,AA,0)
 S A1AXF=$P(^DIZ(11837,+^DIZ(11830,AA,"F"),0),"^",1),A1AXD=$P(^(0),"^",2)
 S A1AXO=$P(^DIZ(11831,+^DIZ(11830,AA,"O"),0),"^",1)
 Q:A1AXDT'=^UTILITY($J,"LAST",A1AXF,A1AXO)
 I $D(^DIZ(11830,AA,"P",AP,"S",AS,"R",AR,13)) S A1AXCAT=$P(^(13),"^",2)
 Q:'$D(A1AXCAT)
 I A1AXOPT="F" S A1AX1=A1AXF,A1AX2=A1AXO
 I A1AXOPT="O" S A1AX1=A1AXO,A1AX2=A1AXF
 S $P(^UTILITY($J,"CAT",A1AXD,A1AX1,A1AX2),"^",A1AXCAT)=$P(^UTILITY($J,"CAT",A1AXD,A1AX1,A1AX2),"^",A1AXCAT)+1
 Q
