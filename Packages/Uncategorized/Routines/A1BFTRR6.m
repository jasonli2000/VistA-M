A1BFTRR6 ;ALBANY ISC ; RESPONSE TIME REPORT FINAL AVERAGES ; ECF ; 23OCT [ 06/15/93  1:23 PM ]
 ;;V1.0
EN ;
 S:'$D(IOM) IOM=132
 S:'$D(IOSL) IOSL=65
FINALS ;
 Q:'$D(^UTILITY("A1BF",$J))
 S A1BFLINE="___________________   "
 S $P(A1BFLN,"=",132)="=" F I=2:1:11 S $P(A1BFLINE,"   ",I)="________"
 S (A1BFLC,A1BFPG)=1
START ;
 D FINTOT^A1BFTRR7,FINAVG^A1BFTRR7
 D RPTHDR,LOOP
 S A1BFDAY=A1BFPDAY S A1BFW=$P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,3)
 D WEEKLY^A1BFTRR3,WEEK
 D LAST^A1BFTRR7
 D ^%ZISC
 D EXIT
 Q
LOOP ;Loop through days in ^UTILITY("A1BF",$J,
 S A1BFDAY=A1BFFIR-.0001 F A1BFI=0:0 S A1BFDAY=$O(^UTILITY("A1BF",$J,A1BFDAY)) Q:A1BFDAY=""!(A1BFDAY'?.N)  S A1BFPDAY=A1BFDAY D PRTDAY D:$P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,1)="FRIDAY" WEEK
 Q
PRTDAY ;Print figures for weekdays
 I A1BFLC>(IOSL-7) D RPTHDR
 Q:$E($P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,1),1,1)="S"
 W !,$J($P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,1),9),"      RT  "
 F A1BFJ=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DATIM")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DATIM"),U,A1BFJ),1:"0"),11,1)
 W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DATIM")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DATIM"),U,27),1:"0"),11,1),! 
 W $J($P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,2),9),$J("# DEV",8),"  "
 F A1BFJ=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DAUSR")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DAUSR"),U,A1BFJ),1:"0"),11,0)
 W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DAUSR")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DAUSR"),U,27),1:"0"),11,1),!
 W $J("# USERS",17),"  "
 F A1BFJ=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DADEV")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DADEV"),U,A1BFJ),1:"0"),11,0)
 W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DADEV")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DADEV"),U,27),1:"0"),11,1),!
 W $J("# TM JOBS",17),"  "
 F A1BFJ=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DATMJ")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DATMJ"),U,A1BFJ),1:"0"),11,0)
 W $J($S($D(^UTILITY("A1BF",$J,A1BFDAY,"DATMJ")):$P(^UTILITY("A1BF",$J,A1BFDAY,"DATMJ"),U,27),1:"0"),11,1),!
 S A1BFLC=A1BFLC+5
 Q
RPTHDR ;
 U IO
 W @IOF,?51,"LOCAL RESPONSE TIME MONITOR STATISTICS",!
 W ?40,"Hourly Averages -- Excluding Response Times Over 10 Seconds",!
 W ?50,"Date Range:  ",A1BFFDP," TO ",A1BFLDP,?120,"PG:",A1BFPG,!,!
 S A1BFPG=A1BFPG+1
 W !,"    DAY",?18," " F A1BFJ=8:1:9 U IO W $J("0"_A1BFJ_"00",11)
 F A1BFJ=10:1:16 U IO W $J(A1BFJ_"00",11)
 U IO W $J("AVERAGE",11)
 W !,A1BFLN,!
 S A1BFLC=9
 Q
WEEK ;
 I A1BFLC>(IOSL-9) D RPTHDR
 W !,A1BFLINE,!
 S A1BFW=$P(^UTILITY("A1BF",$J,A1BFDAY,"DAAY"),U,3)
 W $J("WEEKLY AVERAGE RT",17),"  "
 F A1BFN=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,"WATIM",A1BFW)):$P(^UTILITY("A1BF",$J,"WATIM",A1BFW),U,A1BFN),1:"0"),11,1)
 W $J($P(^UTILITY("A1BF",$J,"WATIM",A1BFW),U,27),11,1),!
 W $J("# DEV",17),"  "
 F A1BFN=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,"WAUSR",A1BFW)):$P(^UTILITY("A1BF",$J,"WAUSR",A1BFW),U,A1BFN),1:"0"),11,0)
 W $J($P(^UTILITY("A1BF",$J,"WAUSR",A1BFW),U,27),11,1),!
 W $J("# USERS",17),"  "
 F A1BFN=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,"WADEV",A1BFW)):$P(^UTILITY("A1BF",$J,"WADEV",A1BFW),U,A1BFN),1:"0"),11,0)
 W $J($P(^UTILITY("A1BF",$J,"WADEV",A1BFW),U,27),11,1),!
 W $J("# TM Jobs",17),"  "
 F A1BFN=9:1:17 D
 .W $J($S($D(^UTILITY("A1BF",$J,"WATMJ",A1BFW)):$P(^UTILITY("A1BF",$J,"WATMJ",A1BFW),U,A1BFN),1:"0"),11,0)
 W $J($P(^UTILITY("A1BF",$J,"WATMJ",A1BFW),U,27),11,1)
 W !,A1BFLINE,!!
 S A1BFLC=A1BFLC+10
 Q
EXIT ;
 K A1BFDAY,A1BFI,A1BFJ,A1BFLC,A1BFLINE,A1BFLN,A1BFN,A1BFPDAY,A1BFPG,A1BFW,I
 Q
