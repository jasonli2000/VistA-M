A4ARIG1 ;HINES CIOFO/JJM-IG REPORTS ; 12/8/98 10:30
V ;;1.0;CLASS III REPORTS OCTOBER 15,1998
 I $D(ACCRUED),(ACCRUED'="") D BSRPT1 Q
PRPTS ; PRINT ALL REPORTS
 D:'$G(^XTMP("A4ARIG",$J,"BILL",0)) EN1^A4ARIG
 D OPEN
 W @IOF
 D BSRPTS
 D CLOSE
 D EOR
 QUIT
BSRPTS ; PRINT BILL STATUS REPORTS
 F ACCRUED=0:1:1 D BSRPT1
 QUIT
BSRPT1 ;
 S SITE=$$SITE^RCMSITE()
 S DATE=^XTMP("A4ARIG",$J,"BILL","DATE/TIME",0)
 W @IOF
 W !!,?40,"BILL DATA REPORT - BY STATUS"
 W !,?42,DATE,!,?40,SITE," JOB NUMBER: ",$J,!
 W !!!,?38,$S(ACCRUED=0:"   NON-ACCRUED/",ACCRUED=1:"ACCRUED/",1:"UNSPECIFIED")," STATUS REPORT - 1",!
 W !,"BILL STATUS ",?40,"COUNT",?50,"TOTAL ",?60,"PRINCIPAL ",?75,"INT ",?84,"ADMIN ",?89,"MRSHL ",?100,"CRT ",!
 S (RTOTAL,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5,RTOTAL6)=0 S STAT=""
 F  S STAT=$O(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT)) Q:STAT=""  D
    . W !,$P($G(^PRCA(430.3,STAT,0)),U,1),?35,$J(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,6),10)
      . S TTOTAL=^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,1)+^(2)+^(3)+^(4)+^(5)
      . S EFLAG=" "
      . S:^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,0)'=TTOTAL EFLAG="*"
           . W ?45,$J(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,0),12,2),$J(^(1),12,2),$J(^(2),10,2),$J(^(3),10,2),$J(^(4),6,2),$J(^(5),8,2),EFLAG
      . S RTOTAL=RTOTAL+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,0)
      . S RTOTAL1=RTOTAL1+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,1)
      . S RTOTAL2=RTOTAL2+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,2)
      . S RTOTAL3=RTOTAL3+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,3)
      . S RTOTAL4=RTOTAL4+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,4)
      . S RTOTAL5=RTOTAL5+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,5)
      . S RTOTAL6=RTOTAL6+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"STATUS",STAT,6)
 W !!,"TOTALS: ",?35,$J(RTOTAL6,10)
 W ?45,$J(RTOTAL,12,2),$J(RTOTAL1,12,2),$J(RTOTAL2,10,2),$J(RTOTAL3,10,2),$J(RTOTAL4,6,2),$J(RTOTAL5,8,2)
 QUIT
OPEN ; SELECT OUTPUT DEVICE
 S %ZIS="M" D ^%ZIS U IO
 QUIT
CLOSE ; CLOSE OUTPUT DEVICE
 D ^%ZISC
 QUIT
EOR ; END OF ROUTINE
 K CAT,FUND,RSC,RTOTAL,STAT,TT,SITE
 K ACCRUED,AMT,AMT1,AMT2,AMT3,AMT4,AMT5,CAT,FUND,RSC,STAT
 K RTOTAL,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5
 K TAMT,TAMT1,TAMT2,TAMT3,TAMT4,TAMT5
