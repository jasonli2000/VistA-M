A4ARIG5 ;HINES CIOFO/JJM-IG REPORTS ; 12/9/98 12:00
V ;;1.0;CLASS III REPORTS OCTOBER 15,1998
 I $D(ACCRUED) D BSRPT5 Q
PRPTS ; PRINT ALL REPORTS
 D:'$G(^XTMP("A4ARIG",$J,"BILL",0)) EN1^A4ARIG
 D NOW^%DTC
 D OPEN
 W @IOF
 D BSRPTS
 D CLOSE
 D EOR
 QUIT
BSRPTS ; PRINT NDB REPORT
 S ACCRUED=1 D BSRPT5
 QUIT
BSRPT5 ;
 ; GET DATE/TIME OF DATA EXTRACT
 S DATE=^XTMP("A4ARIG",$J,"BILL","DATE/TIME",0)
 S SITE=$$SITE^RCMSITE()
 W @IOF
 W !!,?42,"BILL DATA REPORT - NDB SUMMARY"
 W !,?42,DATE,!,?40,SITE," JOB NUMBER: ",$J,!
 ; SCNT - STATUS COUNTER
 ; CCNT - CATEGORY COUNTER
 ; FCNT - FUND COUNTER
 ; RCNT - RSC COUNTER
INIT ;
 N CNT,SCNT,CCNT,FCNT,RCNT
 S (CNT,SCNT,CCNT,FCNT,RCNT)=0
 S (STOTAL,CTOTAL,FTOTAL,GTOTAL,RTOTAL,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5,RTOTAL6)=0,STAT=""
 S (RTOTAL0,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5,RTOTAL6)=0
 S (GTOTAL0,GTOTAL1,GTOTAL2,GTOTAL3,GTOTAL4,GTOTAL5,GTOTAL6)=0
 D NOW^%DTC
 S STAT="",SCNT=0,STOTAL=0
 W !!,?45," NDB REPORT - 5",!
 W !,"RSC/STATUS ",?40,"COUNT",?52,"TOTAL ",?60,"PRINCIPAL ",?76,"INT ",?85,"ADMIN ",?92,"MRSHL ",?102,"CRT ",!
  S FCNT=0,RCNT=0,FTOTAL=0
  S FUND=5287 D
     . S CNT=0
     . S FCNT=FCNT+1
     . S RSC="",RCNT=0
     . F  S RSC=$O(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC)) Q:RSC=""  D
           .. S RCNT=RCNT+1
           .. S (RTOTAL0,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5,RTOTAL6)=0
 .. D RSC
      .. D:CNT>1 TOTALS S FCNT=0,RCNT=0
 W !!,"GRAND TOTALS:",?35,$J(GTOTAL6,10),?45,$J(GTOTAL0,12,2),$J(GTOTAL1,12,2),$J(GTOTAL2,10,2),$J(GTOTAL3,10,2),$J(GTOTAL4,8,2),$J(GTOTAL5,8,2)
 QUIT
RSC ;
 W !
 F STAT=16,28,32,33,40,42,43 D PSTATUS
 D TOTALS
 QUIT
PSTATUS ;
 Q:$D(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,0))=0
 W !,RSC,"  ",$P($G(^PRCA(430.3,STAT,0)),U,1),?35,$J(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,6),10)
 W ?45,$J(^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,0),12,2),$J(^(1),12,2),$J(^(2),10,2),$J(^(3),10,2),$J(^(4),8,2),$J(^(5),8,2)
 S RTOTAL0=RTOTAL0+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,0)
 S RTOTAL1=RTOTAL1+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,1)
 S RTOTAL2=RTOTAL2+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,2)
 S RTOTAL3=RTOTAL3+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,3)
 S RTOTAL4=RTOTAL4+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,4)
 S RTOTAL5=RTOTAL5+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,5)
 S RTOTAL6=RTOTAL6+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,6)
 S GTOTAL0=GTOTAL0+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,0)
 S GTOTAL1=GTOTAL1+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,1)
 S GTOTAL2=GTOTAL2+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,2)
 S GTOTAL3=GTOTAL3+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,3)
 S GTOTAL4=GTOTAL4+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,4)
 S GTOTAL5=GTOTAL5+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,5)
 S GTOTAL6=GTOTAL6+^XTMP("A4ARIG",$J,"ACCRUED",ACCRUED,"FUND",FUND,"RSC",RSC,"STATUS",STAT,6)
 S CNT=CNT+1
 QUIT
TOTALS ;
 W:CNT>1 !,"      TOTALS:",?35,$J(RTOTAL6,10),?45,$J(RTOTAL0,12,2),$J(RTOTAL1,12,2),$J(RTOTAL2,10,2),$J(RTOTAL3,10,2),$J(RTOTAL4,8,2),$J(RTOTAL5,8,2)
CLRDATA S (RTOTAL,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5)=0,CNT=0
 QUIT
OPEN ; SELECT OUTPUT DEVICE
 S %ZIS="M" D ^%ZIS U IO
 QUIT
CLOSE ; CLOSE OUTPUT DEVICE
 D ^%ZISC
 QUIT
EOR ; END OF ROUTINE
 K CAT,FUND,RSC,RTOTAL,STAT,TT,SITE
 K ACCRUED,AMT,AMT1,AMT2,AMT3,AMT4,AMT5,CAT,FUND,RSC,STAT
 K RTOTAL,RTOTAL1,RTOTAL2,RTOTAL3,RTOTAL4,RTOTAL5
 K TAMT,TAMT1,TAMT2,TAMT3,TAMT4,TAMT5
