ASFINSTP ;PROGRAM TO LIST INSTANT PROFILE - ALL BILLS FOR A PATIENT ;11/6/92  12:05
 ;;V1.0 GDM/SYR 10/92 
 S DIC="^PRC(412,",DIC(0)="AELMNQZ" D ^DIC B  G:Y=-1 END S NAME=+Y,PNAME=+Y(0)
 ;S %IS="Q" D ^%ZIS Q:IO=""  S ZTIO=ION
 ;S ZTRTN="PRINT1^ASFINSTP" F G="NAME","ZTIO","PNAME" S ZTSAVE(G)=""
 ;I IO'=IO(0) D ^%ZTLOAD X ^%ZIS("C") W !!,"Request Queued !" Q
PRINT1 S DIC="^PRC(412,",L=0,BY="@NUMBER",(FR,TO)=NAME,FLDS="[ZZ412]"
 S DIOEND="S IOP=ION D PRINT^ASFINSTP K PNAME,FR,TO,DIC,BY,FLDS Q"
 ;S IOP=ZTIO
 R !!,"Do you want to Print to the screen (Y/N): ",ANS
 I ANS="Y"!(ANS="y") S IOP="0;132;66"
 D EN1^DIP
 K DIC,L,BY,FLDS,FR,TO,NAME,ZTRTN,G Q
PRINT S DIC="^DPT(",L=0,BY="@NUMBER",(FR,TO)=PNAME,FLDS="[CAS CURRENT ADMISSION]"
 S IOP=ION_";"_IOST_";"_IOM
 I IO=IO(0) S IOP="0;132;66"
 D EN1^DIP,END Q
END K PNAME,L,BY,FLDS,FR,TO,DIC,ZTSAVE Q
