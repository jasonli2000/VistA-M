AXAREM ;WPB/CAM use in the routine field in file 811.9 for reminders
 ;;1.0;;9/3/98
REM(DFN,TEST,DATE,VALUE,TEXT) ;URINE PROTEIN
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-365 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=149
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REMEN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="NEG"!($P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="TRACE") TEST=1 D
 .S FDATE=9999999-AA
REMEN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM1(DFN,TEST,DATE,VALUE,TEXT) ;HEPATITIS A ANTIBODY TOTAL
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=505
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM1EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="NEG" TEST=1 S FDATE=9999999-AA
REM1EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM2(DFN,TEST,DATE,VALUE,TEXT) ;HEP C AB
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=1354
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM2EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) D
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="POS" TEST=1
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="REACTIVE" TEST=1
 .S FDATE=9999999-AA
REM2EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM3(DFN,TEST,DATE,VALUE,TEXT) ;HBSAG
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=131
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM3EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="NEG" TEST=1 S FDATE=9999999-AA
REM3EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM4(DFN,TEST,DATE,VALUE,TEXT) ;HEPATITIS B SURFACE AG CONFIRMATION
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=1587
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM4EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) D
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="POS" TEST=1
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="REACTIVE" TEST=1
 .S FDATE=9999999-AA
REM4EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM5(DFN,TEST,DATE,VALUE,TEXT) ;HEPATITIS C RIBA
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=1714
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM5EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) D
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="POS" TEST=1
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="REACTIVE" TEST=1
 .S FDATE=9999999-AA
REM5EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM6(DFN,TEST,DATE,VALUE,TEXT) ;HBSAB
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=507
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM6EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) D
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="POS" TEST=1
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="REACTIVE" TEST=1
 .S FDATE=9999999-AA
REM6EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM7(DFN,TEST,DATE,VALUE,TEXT) ;HEP B CORE
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=506
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM7EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) D
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="POS" TEST=1
 .S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)="REACTIVE" TEST=1
 .S FDATE=9999999-AA
REM7EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM8(DFN,TEST,DATE,VALUE,TEXT) ;LDL CHOL CALCULATION >=100
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=902
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM8EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)>99 TEST=1 S FDATE=9999999-AA
REM8EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM9(DFN,TEST,DATE,VALUE,TEXT) ;CHOLESTEROL>=200
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=1383
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM9EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)>199 TEST=1 S FDATE=9999999-AA
REM9EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM10(DFN,TEST,DATE,VALUE,TEXT) ;URINE PROTEIN 30mg/dl or greater in the past 3 years
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-1095 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=149
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM10EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S:$P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)'="NEG"&($P($G(^TMP("LRRR",$J,DFN,"CH",AA,BB)),"^",2)'="TRACE") TEST=1 S FDATE=9999999-AA
REM10EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM11(DFN,TEST,DATE,VALUE,TEXT) ;LDL CHOL CALCULATION >=130
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=902
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM11EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S CC=$P(^TMP("LRRR",$J,DFN,"CH",AA,BB),"^",2) G:CC<130 REM11EN S TEST=1 S FDATE=9999999=AA
REM11EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM12(DFN,TEST,DATE,VALUE,TEXT) ;HGB A1C >= 8
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=97
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM12EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S CC=$P(^TMP("LRRR",$J,DFN,"CH",AA,BB),"^",2) G:CC<8 REM12EN S TEST=1 S FDATE=9999999-AA
REM12EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
REM13(DFN,TEST,DATE,VALUE,TEXT) ;HGB Z1C >=10
 N SUB,SDATE,EDATE
 S DATE=DT
 S SDATE=DT
 S X1=DT,X2=-7300 D C^%DTC S EDATE=X
 S SUB="CH"
 S TEST=97
 D RR^LR7OR1(DFN,,SDATE,EDATE,SUB,TEST,,1)
 S TEST=0,AA=0,BB=0
 S AA=$O(^TMP("LRRR",$J,DFN,"CH",AA)) G:AA="" REM13EN S BB=$O(^TMP("LRRR",$J,DFN,"CH",AA,BB)) S CC=$P(^TMP("LRRR",$J,DFN,"CH",AA,BB),"^",2) G:CC<10 REM13EN S TEST=1 S FDATE=9999999-AA
REM13EN K SDATE,EDATE,SUB,^TMP("LRRR",$J)
 Q
