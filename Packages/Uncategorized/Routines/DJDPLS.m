DJDPLS ;FDJW JA/WASH;DISPLAY SCREEN ; 30 APR 86  11:09 PM
 ;VERSION 1.36
 ;
 S (DJNM,DJDPL)="DJ.DEF2" S DJN=$N(^DJRM("B",DJNM,0)) Q:DJN<1
N S:'$D(DJFF) DJFF=0
 K DJJ,DJF S U="^" S:DJN'=+DJN DJN=$N(^DJRM("B",DJN,0)) S DJ0=^DJRM(DJN,0),DJDPL=$P(DJ0,U,1),DJJ=$P(DJ0,U,2,5),DJDD=$P(DJ0,U,6),V=$N(^DJRM(DJN,1,"A",0)) S:'$D(DJF) DJF=V S:DJF<V DJF=V S:'$D(DJL) DJL=99
 S:'$D(DJKV) DJKV=0 D:'DJFF HDH I DJDD'=+DJDD S DIC="^DJR(DJN,1," G N1
 S DJ0="",DJ1=DJDD F V=1:1 Q:'$D(^DD(DJ1,0,"UP"))  S DJ1=^("UP"),DJ2=$N(^("NM",0)),DJ2=$N(^DD(DJ1,"B",DJ2,0)),DJ2=$P($P(^DD(DJ1,DJ2,0),U,4),";",1) S:DJ2'=+DJ2 DJ2=""""_DJ2_"""" S DJ0="DA("_V_"),"_DJ2_","
 S DIC=^DIC(DJ1,0,"GL")_DJ0,V=DJF
 S:'$D(^DJRM(DJN,1,"A",V)) (DJF,V)=$N(^(V))
N1 S DJ0=^DJRM(DJN,1,$N(^DJRM(DJN,1,"A",V,0)),0) G:$P(DJ0,U,2)="" ER S @$P(DJ0,U,2) X XY I V#1=0 W @DJHIN X XY W $J(V,2)," ",@DJLIN
 W $P(DJ0,U,1) W:$P(DJ0,U,5)>0 ":" I V#1=0 S DJJ(V)=$P(DJ0,U,3,255),@$P(DJ0,U,4) X XY K:$P(DJ0,U,5)'<0&DJKV V(V)
 I V#1=0 I $D(V(V)),(V(V)'="") W @DJHIN X XY S $P(DJDB," ",DJJ(V)-$L(V(V)))=" " W V(V) W:$D(DJDB) DJDB W @DJLIN K DJDB
 E  S $P(DJDB,".",DJJ(V))="." X XY W DJDB K DJDB
 S V=$N(^DJRM(DJN,1,"A",V)) S:V>DJL DJL=V G N1:V>0 S V=DJF
 W @DJEOP K DJ0,DJ1,DJ2
 Q
EN S DJFF=0 G N
EN1 F DJI=6:1:13 I $D(V(DJI)),V(DJI)'="" S $P(DJDB,".",DJJ(DJI))=".",@$P(DJJ(DJI),"^",2) X XY W DJDB K V(DJI)
 K DJDB Q
HDH ;HEADING
 S DJT=$P(DJ0,U,7) W @IOF,?(80-$L(DJT))/2-10,$S(DJOP=2:"ADD/NEW ",DJOP=3:"MODIFY ",1:"        "),DJT,"   ",$E(DT,4,5),"/",$E(DT,6,7),"/",$E(DT,2,3)
 Q
ER Q
