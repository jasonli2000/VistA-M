RJPTF50X ;RJ WILM DE -MAKE N501 PTF CARD; 12-12-85
 ;;4.0
 S RJNEXT=0 F K=1:1 S RJNEXT=$N(^DGPT(I,"M",RJNEXT)) Q:RJNEXT'?.N  S RJN501="N501("_K_")",RJN502="N502("_K_")",RJN503="N503("_K_")" D N50X
 D S K L,D,J,K,X,Y,Z,RJPTF,RJN501,RJ502,RJN502,RJNEXT,RJN503,RJ503 Q
N50X S RJPTF=^DGPT(I,"M",RJNEXT,0),Z=$P(RJPTF,"^",10),Y=$P(^DIC(42.4,$P(RJPTF,"^",2),0),"^",1),Y=$N(^DIC(42.4,"B",Y,0)) S:$L(Y)=1 Y="0"_Y
 S @RJN501=$E(Z,4,7)_$E(Z,2,3)_Y_"  ",Y=$P(RJPTF,"^",3),X=2 D LJ1 S @RJN501=@RJN501_Y,Y=$P(RJPTF,"^",4) D LJ1 S @RJN501=@RJN501_Y
 S @RJN501=@RJN501_$P(^DPT(RJ,57),"^",4),X=6,RJ502=@RJN501 F Z=5:1:9 S Y=$P(RJPTF,"^",Z) D DX,D,LJ S @RJN501=@RJN501_Y
 F Z=11:1:15 S Y=$P(RJPTF,"^",Z) I $P(RJPTF,"^",Z)'="" S:Z=11 @RJN502="N502"_RJCON_RJ502 D DX,D,LJ S @RJN502=@RJN502_Y
 S X=80 I $D(@RJN502) S Y=@RJN502 D LJ S @RJN502=Y
 ;S RJ503=$E(@RJN501,1,6),Z=$P(^DGPT(I,"M",RJNEXT,460000),"^",2),Z=$P(^DIC(16,Z,0),"^",9),@RJN503="N503"_RJCON_RJ503_Z,Y=@RJN503 D LJ S @RJN503=Y
 S Z=" " I $D(^DGPT(I,"M",RJNEXT,460000)) S Z=$P(^(460000),"^",1)
 S @RJN501="N501"_RJCON_@RJN501_Z,Y=@RJN501 D LJ S Y=@RJN501 Q
LJ F J=$L(Y):1:X S Y=Y_" "
 Q
S I $D(@RJN501) F L=1:1:(80-$L(@RJN501)) S @RJN501=@RJN501_" "
 I $D(@RJN502) F L=1:1:(80-$L(@RJN502)) S @RJN502=@RJN502_" "
 Q
LJ1 F J=$L(Y):1:X S Y="0"_Y
 Q
D Q:Y'["."  S D="" F J=1:1:$L(Y) S:$E(Y,J)'="." D=D_$E(Y,J)
 S Y=D Q
DX Q:Y=""  S Y=$P(^ICD9(Y,0),"^",1) Q
