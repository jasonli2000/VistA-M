 ;ATL/ACE PROGRAMMER-MAILING LIST SYSTEM VECSG21
 ;;1
 ;       VARIABLE LIST
 ;
 ;       NAME    =       INDIVIDUAL'S NAME
 ;       ANS     =       USER'S RESPONSE:
 ;       <ENTER>, YES, OR Y IF THEY WANT TO DELETE RECORD
 ;       ANY OTHER RESPONSE IF THEY DON'T WANT TO DELETE
 ;       MISSING =       SET TO 1 IF NAME DOES NOT EXIST
START ;
 W @IOF
 W !!,?20,"DELETE MAILING LIST ENTRY"
NAME ;
 S MISSING=0
 R !!,"ENTER NAME : ",NAME:DTIME I '$T!(NAME["^")!(NAME="") G EXIT
 I NAME'?1U.A1","1U.AP!($L(NAME)>30)!(NAME["?")
 I  W !,"ENTER NAME OF THE NEW ENTRY."
 I  W "  ENTER LAST NAME,FIRST NAME",! G NAME
 D LOOKUP D DELETE:MISSING'=1 G NAME
EXIT ;
 K NAME,ANS,MISSING
 Q
LOOKUP ;
 I $D(^VECS5G(NAME))=0 W !,"RECORD DOES NOT EXIST"
 I  S MISSING=1
 Q
DELETE ;
 R !!,"ARE YOU SURE? NO//",ANS:DTIME
 I '$T!(ANS["^") G DELEXIT
 I (ANS="Y")!(ANS="YES") K ^VECS5G(NAME)
 I  W !,"NAME DELETE!"
 E  W !,"NAME NOT DELETED!"
DELEXIT ;
 Q
