ZZDPT11 ;CHECKS FOR MATCH BETWEEN XREF SSN AND SSN IN PAT RECORD
 ;"DUPS" = MULTIPLE RECORDS FOR SSN
 ;"NONODE" = XREF WITH NO PAT REC
 ;"NOMATCH" = XREF AND PAR REC WITH DIFFERENT SSN'S
SETUP ;
 K ^UTILITY($J)
 S STRT="^" W !,"START WITH SSN NUMBER: " R STRT:DTIME
 Q:STRT["^"  D:STRT["?" EXPLN
 G:STRT'?1.9N SETUP
SETEND ;
 S END="^" W !,"END WITH SSN NUMBER: " R END:DTIME
 
 Q:END["^"  D:END["?" EXPLN
 G:END'?1.9N SETEND
 Q
SCAN ;
 S X="",FOUND=0
 F J=0:0 S X=$O(^DPT(X)) Q:X=""!(X'?.N)  I $D(^DPT(X,0)) I N=$P(^(0),"^",9) S FOUND=1,^UTILITY($J,"NOMATCH",N,N1,X)=N_" FOUND IN RECORD "_X
 S:'FOUND ^UTILITY($J,"NOMATCH",N,N1,"ZIP")=N_" NOT FOUND IN DATABASE"
 Q
 ;
EN ;
 D SETUP
 W !,"Back from setup"
 G:STRT="^"!(END["^") OUT
 S N=STRT-.1,N1=""
 F I=0:0 S N=$O(^DPT("SSN",N)) Q:N=""  S COUNT=0 F J=0:0 S N1=$O(^DPT("SSN",N,N1)) Q:N1=""  S COUNT=COUNT+1 D CHECKS
 W !,"AT END"
OUT ;
 K STRT,END,N,N1,COUNT
 Q
CHECKS ;
 I COUNT>1 S X="" F J=0:0 S X=$O(^DPT("SSN",N,X)) Q:X=""  S ^UTILITY($J,"DUPS",N,X)="DUPLICATE SSN "_N_" POINTS TO REC. "_X 
 I '$D(^DPT(N1,0)) S ^UTILITY($J,"NONODE",N,N1)="SSN XREF "_N_" POINTS TO NON-EXISTENT NODE "_N1 Q
 I $P(^DPT(N1,0),"^",9)'=N S ^UTILITY($J,"NOMATCH",N,N1)="SSN XREF "_N_" POINTS  TO WRONG REC. NO. "_N1 D SCAN
 Q
EXPLN ;
 W !,"ENTER THE SSN WHERE YOU WISH TO ",$S('$D(END):"START",1:"END")
 W !,"YOU CAN DO THE CHECK ON A SECTION AT A TIME"
 Q
