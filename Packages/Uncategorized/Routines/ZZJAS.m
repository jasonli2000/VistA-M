ZZJAS ; ;[ 02/20/96  1:29 PM ]
 ;
 ; THIS ROUTINE CHECK THE %ZTSCH (TASKMAN SCHEDULING GLOBAL) AND LOOKS TO SEE IF THERE ARE ANY
 ; TASKS THAT ARE OLDER THAN THE CURRENT DATE AND TIME.  IT WILL PROVIDE YOU WITH A LIST OF
 ; THE TASK NUMBER, TASK BEING RUN, THE USER, AND THE TASKMAN STATE THE JOB IS IN.  YOU CAN USE
 ; THIS ROUTINE TO DETERMINE IF THERE ARE OLDER TASKS IN THE SCHEDULE LIST THAT MIGHT BE A 
 ; CANIDATE TO BE DELETED.  THIS ROUTINE IS NON-DESTRUCTIVE.
 S IOP="HOME" D ^%ZIS
 W !,"TASK #",?12,"Task Being Run",?50,"User Queuing Task",?72,"State"
 W !,"======",?12,"==============",?50,"=================",?72,"====="
 S ^%ZTSCH("A")=""
 S TIME=$$H3($H)
 S M=$O(^%ZTSCH("")),TASK=$O(^%ZTSCH(M,"")) D EVAL
AGAIN G:$O(^%ZTSCH(M))="A" QUIT S M=$O(^%ZTSCH(M)),TASK=$O(^%ZTSCH(M,"")) D EVAL        
 G AGAIN
H3(%) ;Convert $H to seconds.
 Q 86400*%+$P(%,",",2)
EVAL ; Evaluate the times.
 I TIME>M W !,TASK,?12,$E($P(^%ZTSK(TASK,".03"),"^",1),1,35),?50,$E($P(^VA(200,$P(^%ZTSK(TASK,0),"^",3),0),"^",1),1,20),?74,$P(^%ZTSK(TASK,.1),"^",1)
 ;I TIME>M W !,TASK
 Q
QUIT ;
 K TIME,N,M,TASK,^%ZTSCH("A")
