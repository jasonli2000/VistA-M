VEJDWPBM ;WPB/CAM routine modified for dental GUI;8/1/98
 ;;3.5;VEJD DSS CORE RPCS;;Jan 03, 2006
 ;Copyright 1995-2006, Document Storage Systems, Inc., All Rights Reserved
 ;; ALB/MJK,dcm Report Calls ;9/18/96  15:02
 ;ORWRP1;3.0;ORDER ENTRY/RESULTS REPORTING;**10**;Dec 17, 1997
 ;
AHS(ORDFN,ORHS) ; - get adhoc health summary report
 D START^VEJDWPB3(80,"AHSB^VEJDWPBM(.ORDFN,.ORHS)")
 Q
AHSB(ORDFN,ORHS) ; -build adhoc health summary
 N ORVP,GMTYP,Y
 S ORVP=ORDFN_";DPT("
 S Y=$P($G(^GMT(142,+ORHS,0)),U)
 S GMTSTYP=+ORHS
 ; blj/dss 14/6/2000 Routine ^VEORPRS13 is no longer present.
 ; D ADHOC^VEORPRS13
 Q
HS(ORDFN,ORHS) ; - get health summary report
 D START^VEJDWPB3(80,"HSB^ORWRP1(.ORDFN,.ORHS)")
 Q
 ;
HSB(ORDFN,ORHS) ; - build health summary report
 N ORVP,GMTYP,Y
 S ORVP=ORDFN_";DPT("
 S Y=$P($G(^GMT(142,+ORHS,0)),U)
 S GMTYP(0)=1,GMTYP(1)=+ORHS_U_Y_U_Y_U_Y
 ; blj/dss 14/6/2000  Routine ^VEORPRS13 is no longer present.
 ; D PQ^VEORPRS13
 Q
 ;
HSGUI(DFN,GMTSTYP) ; - Call ENX^GMTSDVR to print HS Type for Patient
 D ENX^GMTSDVR(DFN,GMTSTYP)
 Q
BLR(ROOT,ORDFN) ; -- get 'enhanced' blood bank report
 N DFN,ORY,SUBHEAD
 S DFN=ORDFN,SUBHEAD("BLOOD BANK")=""
 D EN^LR7OSUM(.ORY,DFN,,,,,.SUBHEAD)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="No Blood Bank report available..."
 S ROOT=$NA(^TMP("LRC",$J))
 Q
 ; 
BL(ORDFN) ; -- get blood bank report
 D START^VEJDWPB3(80,"BLB^ORWRP1(.ORDFN)")
 Q
BLB(ORDFN) ; -- build blood bank report
 N DFN
 D SET^LR7OSBB1
 IF $G(OREND)'=1 D
 . S DFN=ORDFN
 . D OERR^LR7OSBB1
 . D CLEAN^LR7OSBB1
 Q
 ; 
PATH(ORDFN) ; -- get anatomic path report
 D START^VEJDWPB3(80,"PATHB^ORWRP1(.ORDFN)")
 Q
 ;
PATHB(ORDFN) ; -- build anatomic path report
 N DFN
 D SET^LRAPS3
 IF $G(OREND)'=1 D
 . S DFN=ORDFN
 . D OERR^LRAPS3
 . D CLEAN^LRAPS3
 Q
 ;
AP(ROOT,ORDFN) ; -- get alternate anatomic path report
 D AP^LR7OSUM(ORDFN)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="No Anatomic Pathology reports available..."
 S ROOT=$NA(^TMP("LRC",$J))
 Q
DIET(ROOT,DFN) ; -- get dietetics profile
 N LCNT,ORVP
 S LCNT=0,ORVP=DFN_";DPT("
 ; blj/dss 14/6/2000  Routine ^VEORCXPNDR is no longer present.
 ; D FHP^VEORCXPNDR
 S ROOT=$NA(^TMP("ORXPND",$J))
 Q
 ;
LISTNUTR(ROOT,DFN) ; -- list nutritional assessments
 N OK K ^TMP($J,"FHADT")
 S ROOT=$NA(^TMP($J,"FHADT",DFN))
 S OK=$$FHWORADT^FHWORA(DFN)
 Q
 ;
NUTR(ROOT,DFN,ID) ; -- get nutritional assessment
 N LCNT,ORVP
 S LCNT=0,ORVP=DFN_";DPT(",ID=DFN_";"_ID
 ; blj/dss 14/6/2000  Routine ^VEORCXPNDR is no longer present.
 ; D FHA^VEORCXPNDR
 S ROOT=$NA(^TMP("ORXPND",$J))
 Q
 ;
DIETB(DFN) ; -- get dietetics profile
 W !!,"Dietetics Profile not yet available."
 Q
 ;
VITALS(DFN,DTRANGE,ORTAG) ; -- get vitals report
 D START^VEJDWPB3(132,"VITALSB^ORWRP1(.DFN,.DTRANGE,.ORTAG)")
 Q
 ;
VITALSB(DFN,DTRANGE,ORTAG) ; -- build vitals report
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP
 S ORVP=DFN_";DPT(",XQORNOD=1
 S X1=DT
 S X2=-$S(DTRANGE:DTRANGE-1,1:0)
 D C^%DTC
 S ORSSTRT(XQORNOD)=X-.7641,ORSSTOP(XQORNOD)=DT+.2359
 ; blj/dss 14/6/2000  Routine ^VEORPRS14 is no longer present.
 ; D @ORTAG^VEORPRS14
 Q
STAT(DFN,ALPHA,OMEGA,DTRANGE) ;Lab Order Status
 D START^VEJDWPB3(80,"STATB^ORWRP1(.DFN,.ALPHA,.OMEGA,.DTRANGE)")
 Q
STATB(DFN,ALPHA,OMEGA,DTRANGE) ;Lab Order Status build
 Q:'$G(DFN)
 I $L(DTRANGE),'$G(ALPHA) S ALPHA=$$FMADD^XLFDT(DT,-DTRANGE),OMEGA=$$NOW^XLFDT
 Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD
 S ORVP=DFN_";DPT(",XQORNOD=1
 D OERR^LR7OSOS(ORVP,ALPHA,OMEGA)
 Q
INTERIM(DFN,ALPHA,OMEGA) ;Lab Interim
 D START^VEJDWPB3(80,"INTERIMB^ORWRP1(.DFN,.ALPHA,.OMEGA)")
 Q
INTERIMB(DFN,ALPHA,OMEGA) ;Build Interim
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP,LRACC,LRAD,LRAN,LRRT,LRPG,LRSB,LREDT,LRIDT
 S ORVP=DFN_";DPT(",XQORNOD=1
 S (ORSSTRT(XQORNOD),LREDT)=(9999999-ALPHA),(ORSSTOP(XQORNOD),LRIDT)=(9999999-OMEGA)
 D OERR^LRRP4,CLEAN^LRRP4
 Q
LRGEN(DFN,ALPHA,OMEGA) ;Lab results by test
 D START^VEJDWPB3(80,"LRGENB^VEJDWPBM(.DFN,.ALPHA,.OMEGA)")
 Q
LRGENB(DFN,ALPHA,OMEGA) ;Build Results
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,ORSSTRT,ORSSTOP,LREDT,LRSDT,XQORNOD
 S ORVP=DFN_";DPT(",XQORNOD=1
 S (ORSSTRT(XQORNOD),LREDT)=(9999999-ALPHA),(ORSSTOP(XQORNOD),LRSDT)=(9999999-OMEGA)
 D SET1^LRGEN,CLEAN^LRRP4
 Q
GRAPH(DFN,ALPHA,OMEGA) ;Graph labs
 D START^VEJDWPB3(80,"GRAPHB^ORWRP1(.DFN,.ALPHA,.OMEGA)")
 Q
GRAPHB(DFN,ALPHA,OMEGA) ;Graph labs
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP,LREDT,LRSDT
 S ORVP=DFN_";DPT(",XQORNOD=1
 S (ORSSTRT(XQORNOD),LREDT)=ALPHA,(ORSSTOP(XQORNOD),LRSDT)=OMEGA
 D OERR^LRDIST4,CLEAN^LRDIST4
 Q
 ;
ORS(DFN,DTRANGE) ;Daily order summary
 D START^VEJDWPB3(80,"ORSB^ORWRP1(.DFN,.DTRANGE)")
 Q
ORSB(DFN,DTRANGE) ;Daily order summary
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP
 S ORVP=DFN_";DPT(",XQORNOD=1
 S X1=DT
 S X2=-$S(DTRANGE:DTRANGE-1,1:0)
 D C^%DTC
 S ORSSTRT=X-.7641,ORSSTOP=DT+.2359
 ; blj/dss 14/6/2000  Routine ^VEORPRS02 is no longer present.
 ; D DAY^VEORPRS02
 Q
ORD(DFN,ALPHA,OMEGA) ;Order Summary for Date Range
 D START^VEJDWPB3(80,"ORDB^VEJDWPBM(.DFN,.ALPHA,.OMEGA)")
 Q
ORDB(DFN,ALPHA,OMEGA) ;Order Summary for Date Range
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP
 S ORVP=DFN_";DPT(",XQORNOD=1
 S ORSSTRT=ALPHA,ORSSTOP=OMEGA
 ; blj/dss 14/6/2000  Routine ^VEORPRS02 is no longer present.
 ;D RANGE^VEORPRS02
 Q
ORC(DFN,ALPHA,OMEGA) ;Custom order summary
 D START^VEJDWPB3(80,"ORCB^VEJDWPBM(.DFN,.ALPHA,.OMEGA)")
 Q
ORCB(DFN,ALPHA,OMEGA) ;Custom order summary build
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP
 S ORVP=DFN_";DPT(",XQORNOD=1
 S ORSSTRT=ALPHA,ORSSTOP=OMEGA
 ; blj/dss 14/6/2000  Routine ^VEORPRS02 is no longer present.
 ; D CUSTOM^VEORPRS02
 Q
ORP(DFN,ALPHA,OMEGA) ;Chart copy summary
 D START^VEJDWPB3(80,"ORPB^VEJDWPBM(.DFN,.ALPHA,.OMEGA)")
 Q
ORPB(DFN,ALPHA,OMEGA) ;Chart copy summary
 Q:'$G(DFN)  Q:'$G(ALPHA)  Q:'$G(OMEGA)
 N ORVP,XQORNOD,ORSSTRT,ORSSTOP
 S ORVP=DFN_";DPT(",XQORNOD=1
 S ORSSTRT=ALPHA,ORSSTOP=OMEGA
 ; blj/dss 14/6/2000  Routine ^VEORPRS02 is no longer present.
 ; D CHART^VEORPRS02
 Q
PSO(DFN) ;Outpatient RX Profile
 D START^VEJDWPB3(80,"PSOB^VEJDWPBM(.DFN)")
 Q
PSOB(DFN) ;Outpatient RX Action Profile
 N ORVP
 S ORVP=DFN_";DPT("
 S PSTYPE=1 D DFN^PSOSD1
 Q
MED(DFN,IID) ;Medicine Summary of Procedures
 D START^VEJDWPB3(80,"MEDB^VEJDWPBM(.DFN,IID)")
 Q
MEDB(DFN,IID) ;Medicine Summary of Procedures
 Q:'$L($G(IID))
 N ORVP
 S ORVP=DFN_";DPT("
 N OT,MCARPPS,MCPRO,MCARGRTN,DXS,DFN,SSN,I,J,L,DA,MCARGDA
 S OT=^TMP("OR",$J,"MCAR","OT",IID),(DA,MCARGDA)=$P(OT,U,2),MCARPPS=$P(OT,U,3,4),MCPRO=$P(OT,U,11) D MCPPROC^MCARP
 S MCARGRTN=$P(OT,U,5)
 D @MCARPPS
 Q
