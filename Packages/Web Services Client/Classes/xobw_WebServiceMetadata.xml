<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="xobw.WebServiceMetadata">
<Description><![CDATA[
This persistent class contains metadata related to HealtheVet web service proxies.
<br>
This class is mapped to rhe VA FileMan WEB SERVICE (#18.02) file 
<br><br>
<b>Restricted Use:</b> The properties and methods of this class are for HWSC use only.
  ]]></Description>
<ClassType>persistent</ClassType>
<ProcedureBlock>1</ProcedureBlock>
<SqlRowIdPrivate>1</SqlRowIdPrivate>
<SqlTableName>WebServiceMetadata</SqlTableName>
<StorageStrategy>WebServiceMetadataStorage</StorageStrategy>
<Super>%Persistent,%XML.Adaptor</Super>
<TimeCreated>60655,58903.747104</TimeCreated>
<Inheritance>right</Inheritance>

<UDLText name="T">
<Content><![CDATA[
// 1.0;HwscWebServiceClient;;September 13, 2010

]]></Content>
</UDLText>

<UDLText name="T">
<Content><![CDATA[
// HealtheVet Web Service Client v1 [Build: 1.0.0.031]

]]></Content>
</UDLText>

<Property name="contextRoot">
<Type>%String</Type>
<SqlFieldName>contextRoot</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="ien">
<Type>%String</Type>
<Required>1</Required>
<SqlFieldName>ien</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="name">
<Type>%String</Type>
<Required>1</Required>
<SqlFieldName>name</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="type">
<Type>%String</Type>
<Required>1</Required>
<SqlFieldName>type</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="proxyClassName">
<Type>%String</Type>
<SqlFieldName>proxyClassName</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Property name="availResource">
<Type>%String</Type>
<SqlFieldName>availRoot</SqlFieldName>
<Parameter name="TRUNCATE" value="1"/>
</Property>

<Index name="ienIndex">
<IdKey>1</IdKey>
<PrimaryKey>1</PrimaryKey>
<Properties>ien</Properties>
<Unique>1</Unique>
</Index>

<Method name="checkResourceAvailability">
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[webServer:xobw.WebServer,authorizedWebService:xobw.WebServicesAuthorized,webService:xobw.WebServiceMetadata,&httpStatusCode:%String]]></FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	set httpRequest=##class(%Net.HttpRequest).%New()
	// are web server and web service enabled
	if ('webServer.status) quit $$$NULLOREF
	if ('authorizedWebService.status) quit $$$NULLOREF
	// set up http request
	do webServer.setUpHttpRequest(httpRequest)
	if webServer.loginRequired="1"!(webServer.loginRequired="") {
		set httpRequest.Username=webServer.userName
		set httpRequest.Password=webServer.getPassword()
	}
	// check resource availability.
	set status=httpRequest.Get(webService.contextRoot_webService.availResource)
	set httpStatusCode=httpRequest.HttpResponse.StatusCode
	if (httpStatusCode="200") {
		quit "1"
	} else {
		quit "0"
	}
]]></Implementation>
</Method>

<Method name="getWebServiceId">
<ClassMethod>1</ClassMethod>
<FormalSpec>name:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	if $get(name)="" {
	    do ##class(xobw.error.DialogError).forceError(186006_"^<empty string>")
	}
	quit +$order(^XOB(18.02,"B",name,0))
]]></Implementation>
</Method>

<Storage name="WebServiceMetadataStorage">
<Type>%CacheSQLStorage</Type>
<StreamLocation>^xobw.WebServiceMetadataS</StreamLocation>
<SQLMap name="MasterMap">
<Type>data</Type>
<ConditionalWithHostVars/>
<Global>^XOB</Global>
<Subscript name="1">
<Expression>18.02</Expression>
</Subscript>
<Subscript name="2">
<Expression>{ien}</Expression>
<LoopInitValue>0</LoopInitValue>
<StopExpression>'+{L2}</StopExpression>
</Subscript>
<RowIdSpec name="1">
<Expression>{L2}</Expression>
<Field>ien</Field>
</RowIdSpec>
<Data name="availRoot">
<Node>201</Node>
</Data>
<Data name="contextRoot">
<Node>200</Node>
</Data>
<Data name="name">
<Delimiter>"^"</Delimiter>
<Node>0</Node>
<Piece>1</Piece>
</Data>
<Data name="proxyClassName">
<Node>100</Node>
</Data>
<Data name="type">
<Delimiter>"^"</Delimiter>
<Node>0</Node>
<Piece>2</Piece>
</Data>
</SQLMap>
</Storage>
</Class>
</Export>
